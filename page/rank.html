
<!DOCTYPE html>
<html lang="ko">
  <head>

    <meta charset="utf-8">
    <meta name="url" content="https://devent.kr">
    <meta name="identifier-URL" content="https://devent.kr">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="https://cdn.devent.kr/img/logo2x.ico">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://devent.kr/">
    <meta property="og:title" content="랭킹 시스템">
    <meta property="og:image" content="https://devent.kr/img/head.png">
    <meta property="og:description" content="순위를 세우고 싶다면? 쉽고 빠른 데벤트의 랭킹 시스템을 이용하세요!">
    <meta property="og:site_name" content="랭킹 시스템">

    <meta property="og:image:width" content="1024">
    <meta property="og:image:height" content="768">
    
    <meta name="twitter:card" content="summary" /> 
    <meta name="twitter:title" content="빠르게 만나는 랭킹 시스템" /> 
    <meta name="twitter:description" content="순위를 세우고 싶다면? 쉽고 빠른 데벤트의 랭킹 시스템을 이용하세요!" /> 
    <meta name="twitter:image" content="https://devent.kr/img/head.png" /> 


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&display=swap" rel="stylesheet">

    <title>랭킹 시스템</title>


    <!-- CSS Dependencies -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shards-ui/3.0.0/css/shards.min.css" integrity="sha512-ATPNLwY6zsriAW9aWaVyzCz5bRunkyNF3m7Es87HrwwhcJ2LwGDHnkPJzNRUOZI4fUcg6kEoNqC/rAUfvRizRw==" crossorigin="anonymous" referrerpolicy="no-referrer" />    
    <link rel="stylesheet" href="/css/style.css"/>
    <link rel="stylesheet" href="/css/hair.css"/>
    <link rel="stylesheet" href="/css/rank.css"/>

  </head>
  <body>

    <div class="modal fade" id="modal_nav" role="dialog_modal_nav">
      <div class="modal-dialog modal-dialog-centered " role="document">
        <div class="modal-content modal-blur">
          <div class="modal-body">
            <h3 class="modal-title text-dark" id="modal_feed_title">설정</h3>
            <br>

            <table class="table text-dark">
              <thead>
                <tr>
                  <th scope="col">이름</th>
                  <th scope="col">포인트</th>
                  <th scope="col">C1</th>
                  <th scope="col">C2</th>
                </tr>
              </thead>
              <tbody id="table_user_setting">
                <tr id="user_aa">
                  <td><input id="username_aa" type="text" class="form-control" placeholder="Enter email" value="김종원"></td>
                  <td><input id="userpoint_aa" type="number" class="form-control" placeholder="Enter email" value="11"></td>
                  <td> <button class="btn btn-success" onclick="editUserInfo('aa')"><i class="fas fa-user-check"></i></button> </td>
                  <td> <button class="btn btn-danger" onclick="removeUser('aa')"><i class="fas fa-user-minus"></i></button> </td>
                </tr>
                <tr id="user_aaa">
                  <td><input id="username_aaa" type="text" class="form-control" placeholder="Enter email" value="김종투"></td>
                  <td><input id="userpoint_aaa" type="number" class="form-control" placeholder="Enter email" value="51"></td>
                  <td> <button class="btn btn-success" onclick="editUserInfo('aaa')"><i class="fas fa-user-check"></i></button> </td>
                  <td> <button class="btn btn-danger" onclick="removeUser('aaa')"><i class="fas fa-user-minus"></i></button> </td>
                </tr>
                <tr id="user_aab">
                  <td><input id="username_aab" type="text" class="form-control" placeholder="Enter email" value="김종쓰리"></td>
                  <td><input id="userpoint_aab" type="number" class="form-control" placeholder="Enter email" value="91"></td>
                  <td> <button class="btn btn-success" onclick="editUserInfo('aab')"><i class="fas fa-user-check"></i></button> </td>
                  <td> <button class="btn btn-danger" onclick="removeUser('aab')"><i class="fas fa-user-minus"></i></button> </td>
                </tr>
                <tr id="user_aac">
                  <td><input id="username_aac" type="text" class="form-control" placeholder="Enter email" value="김종포"></td>
                  <td><input id="userpoint_aac" type="number" class="form-control" placeholder="Enter email" value="191"></td>
                  <td> <button class="btn btn-success" onclick="editUserInfo('aac')"><i class="fas fa-user-check"></i></button> </td>
                  <td> <button class="btn btn-danger" onclick="removeUser('aac')"><i class="fas fa-user-minus"></i></button> </td>
                </tr>
              </tbody>
            </table>

            <button class="btn btn-white btn-block mt-4 rounded" onclick="addUserToSetting()"><i class="fas fa-user-plus"></i> 유저 추가</button>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row mb-5 mt-3">

        <div class="col-lg-4 mb-2">
          <div class="card card-light text-center">
            <div class="card-body">
              <i class="fas fa-crown text-gold icon-lg mb-4"></i>
              <h2 class="title" id="user_1st">김종원</h2>
              <b class="title">1등 <i class="fas fa-caret-right"></i> <b id="user_point_1st"></b>점</b>
            </div>
          </div>
        </div>
        
        <div class="col-lg-4 mb-2">
          <div class="card card-light text-center">
            <div class="card-body">
              <i class="fas fa-crown text-silver icon-lg mb-4"></i>
              <h2 class="title" id="user_2nd">김종원</h2>
              <b class="title">2등 <i class="fas fa-caret-right"></i> <b id="user_point_2nd"></b>점</b>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card card-light text-center">
            <div class="card-body">
              <i class="fas fa-crown text-brown icon-lg mb-4"></i>
              <h2 class="title" id="user_3rd">김종원</h2>
              <b class="title">3등 <i class="fas fa-caret-right"></i> <b id="user_point_3rd"></b>점</b>
            </div>
          </div>
        </div>

      </div>

      <table class="table">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">이름</th>
            <th scope="col">포인트</th>
            <th scope="col">C2</th>
          </tr>
        </thead>
        <tbody id="table_user_list">

        </tbody>
      </table>
    </div>

    <div class="text-center mb-4 mt-5 pt-3 pb-4">
      <h5 class="font-title"> <a href="https://hhj.devent.kr" target="_blank" rel="noopener noreferrer" class="link-normal">@dipokal</a></h5>
    </div>

    <br>



    <div class="fixed-bottom ml-4 mr-4 mt-2 mb-4">
      <button class="btn btn-light btn" type="button" data-toggle="modal" data-target="#modal_nav"><i class="fas fa-cog"></i> 설정</button>
    </div>


    <!-- Optional JavaScript -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shards-ui/3.0.0/js/shards.min.js" integrity="sha512-pY3v/NW9hYmsCbTOeU6NHkNbaTAAGXLTZ27i1MIqHVLwniv/0xt26F5vSKI3jr2bZBJP3k2jRvlilMCp3E1bKg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      let now_rank_index = 3;
      let rank = [
        { id: "aa", name: "김종원", point: 11 },
        { id: "aaa", name: "김종투", point: 51 },
        { id: "aab", name: "김종쓰리", point: 91 },
        { id: "aac", name: "김종포", point: 191 },

      ]

      function init() {
        updateUser()
      }

      function updateUser() {
        let user_list = document.querySelector("#table_user_list");
        clearUserList()
        sortUserRank()

        try {
          document.querySelector("#user_1st").innerText = rank[0].name;
          document.querySelector("#user_point_1st").innerText = rank[0].point;

          document.querySelector("#user_2nd").innerText = rank[1].name;
          document.querySelector("#user_point_2nd").innerText = rank[1].point;

          document.querySelector("#user_3rd").innerText = rank[2].name;
          document.querySelector("#user_point_3rd").innerText = rank[2].point;
        } catch (error) {
        }


        if (rank.length > 3) {
          for (let index = 3; index < rank.length; index++) {
            user_list.insertAdjacentHTML('beforeend', `<tr>
            <th scope="row">${index+1}등</th>
            <td class="title">${rank[index].name}</td>
            <td>${rank[index].point}</td>
            <td>@mdo</td>
          </tr>`);
          } 

        }
      }

      function editUserInfo(id) {
        let user_name = document.querySelector("#username_"+id).value
        let user_point = document.querySelector("#userpoint_"+id).value

        let index = rank.findIndex(element => element.id == id);
        rank[index].name = user_name;
        rank[index].point = Number(user_point);

        console.log(index)
        updateUser()

      }

      function removeUser(id) {
        let div_user_setting = document.querySelector("#user_"+id)

        let index = rank.findIndex(element => element.id == id);
        if (index > -1) rank.splice(index, 1)

        div_user_setting.parentNode.removeChild(div_user_setting);
        updateUser()


      }

      function clearUserList() {
        let user_list = document.querySelector("#table_user_list");
        user_list.innerHTML = ''

        document.querySelector("#user_1st").innerText = '';
        document.querySelector("#user_point_1st").innerText = '';
        document.querySelector("#user_2nd").innerText = '';
        document.querySelector("#user_point_2nd").innerText ='';
        document.querySelector("#user_3rd").innerText = '';
        document.querySelector("#user_point_3rd").innerText ='';
      }

      function sortUserRank() {
        rank.sort((a, b) => {
          if (a.point < b.point) return 1;
          if (a.point > b.point) return -1;

          return 0;
        });
      }

      function makeRandomId() {
        let length = 7;
        let res = '';
        let characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let charactersLength = characters.length;
        for ( var i = 0; i < length; i++ ) {
          res += characters.charAt(Math.floor(Math.random() * charactersLength));
        }
        return res;
      }


      function addUserToSetting() {
        let table = document.querySelector("#table_user_setting");
        let userid = makeRandomId()
        let element = `<tr id="user_${userid}">
                  <td><input id="username_${userid}" type="text" class="form-control" placeholder="Enter name" value=""></td>
                  <td><input id="userpoint_${userid}" type="number" class="form-control" placeholder="Enter point" value="0"></td>
                  <td> <button class="btn btn-success" onclick="editUserInfo('${userid}')"><i class="fas fa-user-check"></i></button> </td>
                  <td> <button class="btn btn-danger" onclick="removeUser('${userid}')"><i class="fas fa-user-minus"></i></button> </td>
                </tr>`

        table.insertAdjacentHTML('beforeend', element);
        rank.push({ id: userid, name: "", point: 0 })

      }

      init()
    </script>
  </body>
</html>